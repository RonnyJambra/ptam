<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Avalia√ß√£o de Im√≥veis - Compara√ß√£o & Ross-Heidecken com Gr√°ficos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container">
  <h2>
    Avalia√ß√£o de Im√≥vel - Compara√ß√£o & Ross-Heidecken com Gr√°ficos
    <button type="button" class="btn theme-toggle" onclick="toggleTema()">üåô/‚òÄÔ∏è Tema</button>
  </h2>
  <div class="amostra-btns">
    <button type="button" class="btn" onclick="addAmostra()">+ Amostra</button>
    <button type="button" class="btn" onclick="removeAmostra()">- Amostra</button>
    <button type="button" class="btn" onclick="exportarPDF()">Exportar PDF</button>
    <button type="button" class="btn" onclick="exportarExcel()">Exportar Excel</button>
  </div>
  <form id="formulario">
    <h3>1. Im√≥veis Referenciais (Amostra)</h3>
    <table>
      <thead>
        <tr>
          <th>Im√≥vel</th>
          <th>Fonte</th>
          <th>Valor (R$)</th>
          <th>√Årea (m¬≤)</th>
          <th>Estado Cons.</th>
          <th>Vida √ötil (anos)</th>
          <th>Idade (anos)</th>
        </tr>
      </thead>
      <tbody id="referenciais"></tbody>
    </table>
    <div class="small">Estado Cons.: A (√ìtimo), B (Muito Bom), C (Bom), D (Intermedi√°rio), E (Regular), F (Deficiente), G (Mau), H (Muito Mau)</div>
    <h3>2. Im√≥vel Avaliando (IA)</h3>
    <table>
      <tr>
        <th>Natureza</th>
        <th>Custo Bruto m¬≤ (R$)</th>
        <th>Estado Cons.</th>
        <th>√Årea (m¬≤)</th>
        <th>Idade (anos)</th>
      </tr>
      <tr>
        <td>
          <select id="ia_natureza" required>
            <option value="">Selecione</option>
            <option value="APARTAMENTOS">APARTAMENTOS</option>
            <option value="CASAS DE ALVENARIA">CASAS DE ALVENARIA</option>
            <option value="CASAS DE MADEIRA">CASAS DE MADEIRA</option>
            <option value="BANCOS">BANCOS</option>
            <option value="HOT√âIS">HOT√âIS</option>
            <option value="LOJAS">LOJAS</option>
            <option value="TEATROS">TEATROS</option>
            <option value="ARMAZ√âNS">ARMAZ√âNS</option>
            <option value="F√ÅBRICAS">F√ÅBRICAS</option>
            <option value="CONST. RURAIS">CONST. RURAIS</option>
            <option value="GARAGENS">GARAGENS</option>
            <option value="EDIF ESCRIT√ìRIOS">EDIF ESCRIT√ìRIOS</option>
            <option value="DEP√ìSITOS">DEP√ìSITOS</option>
            <option value="GALP√ïES">GALP√ïES</option>
            <option value="SILOS">SILOS</option>
          </select>
        </td>
        <td><input type="text" min="0" id="ia_custo" class="valor-input" required></td>
        <td>
          <select id="ia_estado" required>
            <option value="">Selecione</option>
            <option value="A">A - √ìtimo</option>
            <option value="B">B - Muito Bom</option>
            <option value="C">C - Bom</option>
            <option value="D">D - Intermedi√°rio</option>
            <option value="E">E - Regular</option>
            <option value="F">F - Deficiente</option>
            <option value="G">G - Mau</option>
            <option value="H">H - Muito Mau</option>
          </select>
        </td>
        <td><input type="text" min="0" id="ia_area" class="area-input" required></td>
        <td><input type="number" min="0" id="ia_idade" required></td>
      </tr>
    </table>
    <button type="button" class="btn" onclick="calcular()">Calcular Avalia√ß√£o</button>
  </form>
  <div id="resultado" class="result" style="display:none"></div>
  <div id="avaliacaoDetalhe" class="avaliacao-detalhe" style="display:none"></div>
  <h3>Homogeneiza√ß√£o e Diferen√ßa de Idade</h3>
  <table>
    <thead>
      <tr>
        <th>Amostra</th>
        <th>Valor Reduzido (R$)</th>
        <th>√Årea (m¬≤)</th>
        <th>Valor Unit√°rio (R$/m¬≤)</th>
        <th>% Vida √ötil</th>
        <th>Fator Ross-Heidecken</th>
        <th>Valor Homogeneizado (R$/m¬≤)</th>
        <th>Dif. Idade (anos)</th>
        <th>Correla√ß√£o RH</th>
      </tr>
    </thead>
    <tbody id="tabelaHomogeneizacao"></tbody>
  </table>
  <h3>Gr√°ficos Comparativos</h3>
  <canvas id="graficoValoresBrutos" width="600" height="300"></canvas>
  <canvas id="graficoValoresM2" width="600" height="300"></canvas>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.7.0/jspdf.plugin.autotable.min.js"></script>
<script src="script.js"></script>
</body>
</html>
